source("/media/general/projects/NCI_60_phospho/Chen/R/drugResponseProcess/extract.drugmat.nci60.R")
dtp <- read.delim("/media/msdata5/users_files/Chen/Projects/PhosphoNCI60/Data/DTP_DrugSensitivity/DTP_NCI60.xls/DTP_NCI60_1_5_1.txt", 
                  comment.char = "#", check.names = FALSE, as.is = TRUE)
kbs <- read.delim("/media/general/projects/NCI_60_phospho/Chen/Dat/kbscreen&review/kinobeadScreen.txt")

## direct mapping
drug.nop <- tolower(unlist(lapply(dtp$Name, function(x) gsub("[[:punct:]]| ", "", x))))
bks.nop <- tolower(unlist(lapply(levels(kbs$Drug), function(x) gsub("[[:punct:]]| ", "", x))))
intersect(drug.nop, bks.nop)


# synonyms (run bottom first to have all synonyms)
# comparison with U:\projects\KinobeadDrugScreen\DrugScreen_paper\FINAL supplemental tables for upload\Supplementary Table 1 Inhibitors.xlsx
syn <- lapply(strsplit(synonyms, ","), function(x) tolower(gsub("[[:punct:]]| ", "", x)))

tt <- sapply(syn, function(x) x %in% drug.nop)
syn[sapply(tt, function(x) any(x))]


sapply(syn[sapply(tt, function(x) any(x))], function(x) x[x %in% c(drug.nop)])



d <- rbind(
  cbind(unique(drug.nci60$dtp.annot[drug.nci60$dtp.annot$kinoScreen == 1, ]$Name), 
        unique(drug.nci60$dtp.annot[drug.nci60$dtp.annot$kinoScreen == 1, ]$Name)), 
  c("Certican",	"Everolimus"), 
  c("Torisel",	"Temsirolimus"), 
  c("AXL-1717", "Picropodophyllin" )
)

colnames(d) <- c("KinoBeadName", "DTPmapName")
write.table(d, file = "Res/20170307_countingComparison/KBdrugScreenMapping.txt", 
            col.names = TRUE, row.names = FALSE, sep = ",", quote = FALSE)









synonyms <- c(
  "LY-2835219",
  "BMS-599626",
  "NVP-AEE788, GNF-Pf-5343",
  "NVP-AEW541",
  "Afatinib Dimaleate, BIBW2992-MA2, BIBW-2992",
  "AF-802, CH-5424802, AF-802, CH-5424802",
  "MLN-8237, MLN-8237-004, Alisertib Sodium",
  "HL-275, HMR-1275, L-868275, L-86-8275, NSC-649890, MDL-107826A, Flavopiridol, Alvocidib HCl",
  "HPK56, HPK-56, MP-470, MP-470.HCl, Amuvatinib HCl",
  "YN-968D1",
  "RG-7422, G-038390, GDC-0980.1, G-038390.1, GDC-0980",
  "ONT-380, Irbinitinib, Tucatinib",
  "MP-412",
  "AG-013736, Inlyta, AG-13736",
  "Picropodophyllin, Picropodophyllotoxin",
  "KB-74810",
  "AZ-12600000",
  "ARRY-704, ARRY-424704",
  "CNS-9, NS-187, INNO-406",
  "AZD-1152",
  "AZD-1152-HQPA",
  "INCB-28050, LY-3009104, INCB-028050",
  "NVP-BGT226",
  "ARRY-162, MEK-162, NVP-MEK162, ARRY-438162",
  "SNS-032",
  "Bosulif, SKI-606, Bosutinib Monohydrate",
  "BMS-540215",
  "BMS-582664",
  "BKM-120, BKM120-NX, Buparlisib HCl, NVP-BKM120, BKM120-AAA",
  "Alpelisib, NVP-BYL719",
  "BMS-907351, Cometriq, Cabozantinib S-Malate, XL-184",
  "PD-0183805, PD-183805, Canertinib Dihydrochloride, CI-1033, SN-26606",
  "NVP-INC280, INC-280, INCB-28060",
  "AZD-2171, ZD-2171, Recentin, Cediranib Maleate",
  "PRT-2070, PRT-062070",
  "NVP-LDK378-NX",
  "RAD001, Afinitor, Zortress, Everolimus, Afinitor Disperz",
  "RG-7420, GDC-0973, Cobimetinib Fumarate, XL-518, RG-7420, RG-7421, GDC-0973",
  "BAY 84-1236, BAY-80-6946, BAY 80-6946, Copanlisib hydrochloride",
  "OSI-632",
  "ARO-002-26, CP-868596, ARO-002, Crenolanib Besylate, 596-26, CP-868",
  "Xalkori, PF-2341066",
  "GSK2118436A, GSK2118436B, Dabrafenib Mesylate",
  "PF-00299804, PF-00299804-03",
  "BEZ-235, NVP-BEZ235, NVP-BEZ235-NX, NVP-BEZ235-ANA, Dactolisib Tosylate",
  "PHA-739358",
  "Sprycel, BMS-354825-03, BMS-354825",
  "Adelatinib, VX-509, VRT-831509",
  "PF-04554878, VS-6063, Defactinib Hydrochloride",
  "MK-8669, AP-23573, Ridaforolimus",
  "MK-7965, SCH-727965",
  "TKI-258, CHIR-258, Dovitinib Lactate, NVP-TKI258, GFKI-258",
  "NVP-LGX818, LGX-818, NVP-LGX818-NXA",
  "RXDX-101, NMS-E628",
  "LY-317615, Enzastaurin HCl",
  "RG-1415, Tarceva, OSI-774, R-1415, CP-358774, Ro-508231, CP-35877401, CP-358774-01, Erlotinib HCl",
  "HA-1077, AT-877, ZK-258594",
  "SAR-302503, TG-101348, TG-101348, TG101348, SAR-302503",
  "G-146034, GLPG-0634, G-146034_101, Filgotinib hydrochloride",
  "GSK089, XL-880, EXEL-2880, GSK1363089, GSK1363089G",
  "R-788, R-935788, R-788 Sodium, R-788 Free acid, R-935788 Sodium, R-935788 Free acid, Fostamatinib Disodium",
  "LY-2157299",
  "PKI-587, PF-05212384",
  "Iressa, ZD-1839",
  "Gilteritinib fumarate, ASP-2215 HEMIFUMARATE, ASP-2215",
  "E7050, E-7050, Golvatinib Tartrate, ER-396901-08",
  "GSK615",
  "GSK2110183B, Afuresertib, GSK2110183, GSK2110183C, Afuresertib HCl",
  "GSK2636771",
  "GSK461364, GSK461364A",
  "VX-214",
  "CRA-032765, PCI-32765-00, PCI-32765",
  "BPI-2009",
  "GS-1101, CAL-101, GS-11CAL-101",
  "Gleevec, Imatinib mesylate, STI-571",
  "WHI-P131",
  "SF 2370",
  "GW-2016, GW-572016, GW572016F, Lapatinib Ditosylate, Tykerb, Lapatinib ditosylate monohydrate",
  "E7080, ER-203492-00, Lenvatinib Mesylate",
  "CEP-701, SP-924, KT-555, SP924, KT-5555, A-1544750, SPM-924, A-154475",
  "ABT-869, RG-3635, AL-39324",
  "OSI-906, ASP-7487, OSI-906AA",
  "GSKAHAB, GW856553, GW856553X",
  "E-3810, AL-3810, CO-3810, S-80881",
  "Merestinib",
  "AB-1010",
  "PKC-412, CGP-41251, NVP-PKC412",
  "PHA-848125",
  "AZD-1775",
  "VX-689",
  "CYT-387, Momelotinib Dihydrochloride, CYT-11387, GS-0387",
  "AMG-706, Motesanib Diphosphate",
  "TAK-165",
  "CDP-820, HKI-272, WAY-179272",
  "AMN-107, Tasigna, Nilotinib Hydrochloride Monohydrate",
  "BIBF-1120, Nintedanib Esylate",
  "GSK2126458",
  "TSU-68, SU-6668",
  "AZD-9291, Osimertinib mesylate, AZD-9291 mesylate",
  "P-27600",
  "ONX-0803, SB-1518, SB1518",
  "PD-0332991, PF-0008066573, Palbociclib Isethionate, PD-03329910054",
  "GW786034, Votrient, Pazopanib HCl, GW786034B",
  "PD-0325901",
  "EKB-569, WAY-EKB-569",
  "KRX-0401",
  "PLX-3397",
  "ARRY-614",
  "PF-03758309",
  "PF-00477736",
  "PF-00562271",
  "PHA-797804",
  "RG-7321, GDC-0941",
  "XL-147, SAR-245408",
  "AS-703026, MSC-1936369B, EMD 1036239",
  "AP-24534 HCl, AP-24534, Iclusig, Ponatinib HCl",
  "HM-781-36B, NOV-120101",
  "AC220, AC-220, Quizartinib Dihydrochloride, AC010220.2HCl, AC010220, ASP-2689",
  "RG-547",
  "IC-83, LY-2603618",
  "CHIR-265, NVP-RAF265",
  "Rapamune, AY-22989, Sirolimus, WY-090217",
  "DP-1919, DCC-2036, Rebastinib Tosylate",
  "RDEA-119, BAY-86-9766",
  "Stivarga, BAY-73-4506, BAY-734506 monohydrate",
  "LEE-011, NVP-LEE011",
  "Rigosertib Sodium, ON-01910.Na, ON-01910",
  "K-115",
  "CH-4987655",
  "RG-7304, CKI-27",
  "AVL-301, CNX-419, CO-1686",
  "LY-333531",
  "INCB-018424, Jakafi, Ruxolitinib Phosphate, INCB-018424 Salt",
  "TAK-228, MLN0128, INK128, MLN-0128",
  "AZD-8931",
  "AZ-10353926, Saracatinib Difumarate, AZD-0530 difumarate, AZD-0530",
  "TG02, TG-02",
  "MK-8776",
  "Rosovitine, CYC-202, AL-39256",
  "AZD-6244 HYD-SULFATE, ARRY-886, ARRY-142886, AZD-6244 Hydrogen sulfate, AZD-6244, Selumetinib Sulfate",
  "CX-4945",
  "PX-866",
  "[11C]-Sorafenib, Sorafenib Tosylate, BAY-54-9085, BAY-43-9006, Nexavar",
  "AEB071, AEB-071, Sotrastaurin Acetate, NVP-AEB071",
  "SU-014813",
  "SU-11248, Sutent, Sunitinib Malate",
  "SCIO-469",
  "MLN-518, CT-53518, MLN-0518",
  "CC-930, JNK-930",
  "BAY-57-9352, BAY-579352",
  "MSC-2156119J, MSC-2156119, EMD-1214063",
  "KD-019, KD-020, XL-647, Tesevatinib tosylate",
  "TG100-115",
  "TG100-801",
  "NP-031112, NP-12",
  "ARQ-197",
  "AV-951, KRN-951, Kil8951, Tivozanib HCl, Kil-8951, ASP-4130",
  "Tasocitinib, Tofacitinib Citrate, CP-690, Xeljanz, CP-690550-10, Tasocitinib Citrate, CP-690550",
  "CCI-779, Temsirolimus",
  "VX-68, MK-045, Tozasertib Lactate, MK-0457, VX-680",
  "GSK1120212, GSK1120212B, Trametinib Dimethyl Sulfoxide",
  "Phosphate Salt Of Tricyclic Nucleoside, Triciribine Phosphate, VQD-002",
  "UCN-02, KRX-0601, KW-2401",
  "BVD-523, VRT-752271",
  "GSK2141795, GSK2141795C",
  "Caprelsa, GNF-Pf-2188, Zactima, ZD-64, ZD-6474",
  "ARRY-543, ASLAN-001, AR-00334543, ARRY-334543, Varlitinib Tosylate",
  "PTK787, PTK-787, K-222584, CGP-79787, BAY-86-5127, ZK-222584, CGP-79787D, NVP-PTK787",
  "PLX-4032, Ro-5185426, RG-7204, Zelboraf",
  "BI-6727, BI-6727-CL3, Volasertib Trihydrochloride",
  "AZD-6094, Savolitinib",
  "BMS-863233",
  "SAR-245409, Voxtalisib",
  "Y-33075")
